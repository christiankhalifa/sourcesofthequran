<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quran Reference Form</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 40px;
      background: linear-gradient(135deg, #e0f7fa, #f1f8e9);
    }
    form {
      max-width: 900px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 8px 18px rgba(0,0,0,0.1);
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px 30px;
    }
    h2 {
      grid-column: 1 / -1;
      text-align: center;
      margin-bottom: 20px;
      color: #2e7d32;
    }
    label {
      display: block;
      margin-bottom: 6px;
      font-weight: bold;
      color: #333;
    }
    input, select, textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.3s ease;
    }
    input:focus, select:focus, textarea:focus {
      border-color: #2e7d32;
      box-shadow: 0 0 6px rgba(46,125,50,0.4);
      outline: none;
    }
    textarea {
      resize: vertical;
      min-height: 80px;
    }
    button {
      grid-column: 1 / -1;
      margin-top: 15px;
      padding: 14px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: bold;
      background: linear-gradient(135deg, #4caf50, #2e7d32);
      color: white;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s;
    }
    button:hover {
      background: linear-gradient(135deg, #43a047, #1b5e20);
      transform: translateY(-2px);
    }

    .inline-field {
      display: flex;
      align-items: flex-start;
      gap: 10px;
    }
    .inline-field select,
    .inline-field input {
      flex: 1;
    }
    .inline-field textarea {
      flex: 2;
      opacity: 0;
      max-height: 0;
      overflow: hidden;
      transition: opacity 0.4s ease, max-height 0.4s ease;
    }
    .inline-field textarea.visible {
      opacity: 1;
      max-height: 300px;
    }

    /* Fade animation for interpolation */
    #interpol {
      opacity: 0;
      max-height: 0;
      overflow: hidden;
      transition: opacity 0.4s ease, max-height 0.4s ease;
    }
    #interpol.visible {
      opacity: 1;
      max-height: 300px;
    }

    @media (max-width: 768px) {
      form { grid-template-columns: 1fr; }
      .inline-field { flex-direction: column; }
    }
  </style>
</head>
<body>

  <form id="myForm">
    <h2>Quran Reference Form</h2>

    <div><label for="surah">Surah Number:</label><input type="number" id="surah" name="surah" min="1" max="114" required></div>
    <div><label for="ayat">Ayat:</label><input type="text" id="ayat" name="ayat" placeholder="e.g., 1-5"></div>

    <div>
      <label for="category">Category:</label>
      <select id="category" name="category">
        <option value="">-- Select Category --</option>
        <option value="Biblical">Biblical</option>
        <option value="Jewish">Jewish</option>
        <option value="Christian">Christian</option>
        <option value="Other">Other</option>
      </select>
    </div>

    <div><label for="reference">Reference:</label><input type="text" id="reference" name="reference"></div>
    <div><label for="link">Link to the Source:</label><input type="text" id="link" name="link"></div>
    <div><label for="source">Source Name:</label><input type="text" id="source" name="source"></div>
    <div><label for="rewr">Rewrite/Response:</label><input type="text" id="rewr" name="rewr"></div>
    <div><label for="lang">Presumed Original Language:</label><input type="text" id="lang" name="lang"></div>
    <div><label for="origin">Presumed Place of Origin:</label><input type="text" id="origin" name="origin"></div>
    <div><label for="credit-text">Credit for Text:</label><input type="text" id="credit-text" name="credit-text"></div>
    <div><label for="credit-ms">Credit for Manuscript Name:</label><input type="text" id="credit-ms" name="credit-ms"></div>
    <div><label for="ms-name">MS Name:</label><input type="text" id="ms-name" name="ms-name"></div>
    <div><label for="preserved-text">Preserved Text (.. to ..):</label><input type="text" id="preserved-text" name="preserved-text"></div>
    <div><label for="language">Language:</label><input type="text" id="language" name="language"></div>
    <div><label for="archive">Archive:</label><input type="text" id="archive" name="archive"></div>
    <div><label for="ref-ms">Reference to Manuscript:</label><input type="text" id="ref-ms" name="ref-ms"></div>
    <div><label for="date-range">Date Range:</label><input type="text" id="date-range" name="date-range" placeholder="e.g., 700–750 CE"></div>
    <div><label for="ref-transcription">Reference to Manuscript Transcription:</label><input type="text" id="ref-transcription" name="ref-transcription"></div>
    <div><label for="translator">Translator:</label><input type="text" id="translator" name="translator"></div>
    <div><label for="ref-translation">Reference to Manuscript Translation:</label><input type="text" id="ref-translation" name="ref-translation"></div>

    <!-- Frequent Formula -->
    <div>
      <label for="frequent-formula">Frequent Formula:</label>
      <div class="inline-field">
        <select id="frequent-formula" name="frequent-formula">
          <option value="">-- Select --</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
        <textarea id="frequent-formula-text" name="frequent-formula-text" placeholder="Describe the frequent formula"></textarea>
      </div>
    </div>

    <!-- Unit + Interpolation side by side -->
    <div>
      <label for="unit">Unit (... to …):</label>
      <div class="inline-field">
        <input type="text" id="unit" name="unit" placeholder="e.g., verse 1 to verse 5">
        <textarea id="interpol" name="interpol" placeholder="Interpolation (separate multiple with ;)"></textarea>
      </div>
    </div>

    <!-- Parallel Passages -->
    <div>
      <label for="par-pass-pp">Parallel Passages:</label>
      <div class="inline-field">
        <select id="par-pass-pp" name="par-pass-pp">
          <option value="">-- Select --</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
        <textarea id="par-pass-semicolon" name="par-pass-semicolon" placeholder="Separate multiple with ; if needed"></textarea>
      </div>
    </div>

    <!-- Related Passages -->
    <div>
      <label for="rel-passages-select">Related Passages:</label>
      <div class="inline-field">
        <select id="rel-passages-select" name="rel-passages-select">
          <option value="">-- Select --</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
        <textarea id="rel-passages" name="rel-passages" placeholder="Separate multiple with ; if needed"></textarea>
      </div>
    </div>

    <button type="submit">Submit</button>
  </form>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbxrON6JKaLU8BY-Q_Wz9-hfA7vCazhbwBjrvP7vAnDWTURD5pIAijJ2mDX1Zk_zcQhRkg/exec";
    const form = document.getElementById("myForm");

    // Helper for "Yes/No" logic with fade
    const setupToggle = (selectId, textAreaId) => {
      const select = document.getElementById(selectId);
      const textarea = document.getElementById(textAreaId);
      select.addEventListener("change", () => {
        if (select.value === "Yes") textarea.classList.add("visible");
        else textarea.classList.remove("visible");
      });
    };

    setupToggle("frequent-formula", "frequent-formula-text");
    setupToggle("par-pass-pp", "par-pass-semicolon");
    setupToggle("rel-passages-select", "rel-passages");

    // Unit activates interpolation
    const unitField = document.getElementById("unit");
    const interpol = document.getElementById("interpol");
    unitField.addEventListener("input", () => {
      if (unitField.value.trim()) interpol.classList.add("visible");
      else interpol.classList.remove("visible");
    });

    // Form submission
    form.addEventListener("submit", e => {
      e.preventDefault();

      const multiFields = ["interpol", "par-pass-semicolon", "rel-passages"];
      multiFields.forEach(id => {
        const el = document.getElementById(id);
        if (el && el.value) {
          const val = el.value.trim();
          if (/[,;\n]/.test(val)) {
            el.value = val.split(/[,;\n]+/).map(v => v.trim()).filter(v => v).join("; ");
          }
        }
      });

      const formData = new FormData(form);
      fetch(scriptURL, { method: "POST", body: formData })
        .then(res => res.text())
        .then(() => {
          alert("✅ Submitted successfully!");
          form.reset();
          document.querySelectorAll("textarea").forEach(t => t.classList.remove("visible"));
        })
        .catch(err => alert("❌ Error: " + err));
    });
  </script>
</body>
</html>
